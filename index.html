<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Automation Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .header p { opacity: 0.9; font-size: 1.1em; }
        .main { padding: 40px; }
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
        }
        .tab {
            padding: 15px 30px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }
        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .form-group { margin-bottom: 25px; }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }
        .form-group textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }
        .btn {
            padding: 15px 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .alert {
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
            display: none;
        }
        .alert.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }
        .alert.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }
        .alert.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
            display: block;
        }
        .info-box {
            background: #fff3cd;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #ffc107;
        }
        .video-list { margin-top: 30px; }
        .video-item {
            background: #f8f9fa;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        .video-item h3 { margin-bottom: 10px; }
        .video-item .status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }
        .status.pending { background: #ffc107; color: #000; }
        .status.generating { background: #2196f3; color: #fff; }
        .status.complete { background: #4caf50; color: #fff; }
        .status.failed { background: #f44336; color: #fff; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé¨ Video Automation System</h1>
            <p>One-click cloud video generation</p>
        </div>
        
        <div class="main">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('create')">Create Video</button>
                <button class="tab" onclick="switchTab('queue')">Video Queue</button>
                <button class="tab" onclick="switchTab('settings')">Settings</button>
            </div>
            
            <!-- Create Video Tab -->
            <div id="create" class="tab-content active">
                <div id="setupAlert" class="alert info">
                    <strong>‚öôÔ∏è Setup Required:</strong> Go to Settings tab and add your GitHub token first.
                </div>
                
                <div id="createAlert" class="alert"></div>
                
                <h2 style="margin-bottom: 20px;">Create New Video</h2>
                <form id="videoForm">
                    <div class="form-group">
                        <label>Video Title</label>
                        <input type="text" id="title" placeholder="Enter an engaging title..." required>
                    </div>
                    
                    <div class="form-group">
                        <label>Script (Hook ‚Üí Value ‚Üí CTA) - Keep under 60 seconds</label>
                        <textarea id="script" placeholder="Write your video script here..." required></textarea>
                        <small style="color: #666;">Aim for 150-170 words (45-55 seconds)</small>
                    </div>
                    
                    <div class="form-group">
                        <label>Keyword (for background footage)</label>
                        <input type="text" id="keyword" placeholder="e.g., motivation, money, success" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Niche</label>
                        <select id="niche">
                            <option value="finance">Finance/Money</option>
                            <option value="self-improvement">Self Improvement</option>
                            <option value="productivity">Productivity</option>
                            <option value="health">Health/Fitness</option>
                            <option value="tech">Technology</option>
                            <option value="business">Business</option>
                            <option value="motivation">Motivation</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Tags (comma separated)</label>
                        <input type="text" id="tags" placeholder="viral, motivation, success">
                    </div>
                    
                    <button type="submit" class="btn" id="generateBtn">üöÄ Generate Video (Cloud)</button>
                </form>
            </div>
            
            <!-- Queue Tab -->
            <div id="queue" class="tab-content">
                <h2 style="margin-bottom: 20px;">Video Generation Queue</h2>
                <div id="queueAlert" class="alert"></div>
                <div id="videoList" class="video-list"></div>
            </div>
            
            <!-- Settings Tab -->
            <div id="settings" class="tab-content">
                <h2 style="margin-bottom: 20px;">GitHub Configuration</h2>
                
                <div class="info-box">
                    <h3>üîë Setup Instructions:</h3>
                    <ol style="margin-top: 10px; line-height: 1.8; margin-left: 20px;">
                        <li>Go to <a href="https://github.com/settings/tokens/new" target="_blank">GitHub Token Settings</a></li>
                        <li>Click "Generate new token (classic)"</li>
                        <li>Name it: "Video Automation"</li>
                        <li>Select scopes: ‚úÖ <strong>repo</strong> (all sub-options)</li>
                        <li>Click "Generate token"</li>
                        <li>Copy the token (starts with ghp_)</li>
                        <li>Paste it below and save</li>
                    </ol>
                </div>
                
                <div id="settingsAlert" class="alert"></div>
                
                <div class="form-group">
                    <label>GitHub Personal Access Token</label>
                    <input type="password" id="githubToken" placeholder="ghp_...">
                    <small style="color: #666;">This is stored locally in your browser</small>
                </div>
                
                <div class="form-group">
                    <label>GitHub Username</label>
                    <input type="text" id="githubUsername" value="googlebud" placeholder="googlebud">
                </div>
                
                <div class="form-group">
                    <label>Repository Name</label>
                    <input type="text" id="githubRepo" value="video-automation" placeholder="video-automation">
                </div>
                
                <button class="btn" onclick="saveSettings()">üíæ Save Settings</button>
                <button class="btn" style="background: #dc3545;" onclick="clearSettings()">üóëÔ∏è Clear Settings</button>
                
                <div style="margin-top: 30px; padding: 20px; background: #e3f2fd; border-radius: 8px;">
                    <h4>üìä How It Works:</h4>
                    <p style="margin-top: 10px; line-height: 1.6;">
                        1. You create a video using the form<br>
                        2. System commits a JSON file to your GitHub repo<br>
                        3. GitHub Actions automatically generates the video<br>
                        4. Download the video from Actions artifacts<br>
                        <br>
                        Check progress: <a href="https://github.com/googlebud/video-automation/actions" target="_blank">GitHub Actions</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let videos = JSON.parse(localStorage.getItem('videos') || '[]');
        
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            if (tabName === 'queue') updateVideoList();
            checkSetup();
        }
        
        function checkSetup() {
            const token = localStorage.getItem('githubToken');
            const alert = document.getElementById('setupAlert');
            if (!token) {
                alert.style.display = 'block';
            } else {
                alert.style.display = 'none';
            }
        }
        
        function showAlert(elementId, message, type) {
            const alert = document.getElementById(elementId);
            alert.textContent = message;
            alert.className = `alert ${type}`;
            setTimeout(() => alert.className = 'alert', 5000);
        }
        
        async function commitToGitHub(filename, content) {
            const token = localStorage.getItem('githubToken');
            const username = localStorage.getItem('githubUsername') || 'googlebud';
            const repo = localStorage.getItem('githubRepo') || 'video-automation';
            
            if (!token) {
                throw new Error('GitHub token not configured. Go to Settings tab.');
            }
            
            const url = `https://api.github.com/repos/${username}/${repo}/contents/${filename}`;
            
            const response = await fetch(url, {
                method: 'PUT',
                headers: {
                    'Authorization': `token ${token}`,
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    message: `Add video content: ${filename}`,
                    content: btoa(unescape(encodeURIComponent(content))),
                    branch: 'main'
                })
            });
            
            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.message || 'Failed to commit to GitHub');
            }
            
            return await response.json();
        }
        
        document.getElementById('videoForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const btn = document.getElementById('generateBtn');
            btn.disabled = true;
            btn.textContent = '‚è≥ Generating...';
            
            try {
                const video = {
                    title: document.getElementById('title').value,
                    script: document.getElementById('script').value,
                    keyword: document.getElementById('keyword').value,
                    niche: document.getElementById('niche').value,
                    tags: document.getElementById('tags').value.split(',').map(t => t.trim()),
                    created: Date.now(),
                    status: 'generating'
                };
                
                // Create JSON content
                const contentJSON = {
                    videos: [{
                        title: video.title,
                        script: video.script,
                        keyword: video.keyword,
                        tags: video.tags,
                        niche: video.niche
                    }]
                };
                
                const filename = `content_${Date.now()}.json`;
                const content = JSON.stringify(contentJSON, null, 2);
                
                // Commit to GitHub
                await commitToGitHub(filename, content);
                
                // Save to local queue
                videos.push(video);
                localStorage.setItem('videos', JSON.stringify(videos));
                
                showAlert('createAlert', `‚úÖ Success! Video generation started. Check GitHub Actions for progress.`, 'success');
                this.reset();
                
                // Open GitHub Actions in new tab
                setTimeout(() => {
                    window.open('https://github.com/googlebud/video-automation/actions', '_blank');
                }, 1000);
                
            } catch (error) {
                showAlert('createAlert', `‚ùå Error: ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
                btn.textContent = 'üöÄ Generate Video (Cloud)';
            }
        });
        
        function updateVideoList() {
            const list = document.getElementById('videoList');
            if (videos.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">No videos generated yet. Create one!</p>';
                return;
            }
            
            list.innerHTML = videos.map((v, i) => `
                <div class="video-item">
                    <h3>${v.title}</h3>
                    <p style="color: #666; margin: 10px 0;">${v.script.substring(0, 100)}...</p>
                    <div style="margin-top: 10px;">
                        <span class="status ${v.status}">${v.status.toUpperCase()}</span>
                        <span style="margin-left: 15px; color: #666; font-size: 14px;">
                            ${new Date(v.created).toLocaleString()}
                        </span>
                    </div>
                </div>
            `).join('');
        }
        
        function saveSettings() {
            const token = document.getElementById('githubToken').value;
            const username = document.getElementById('githubUsername').value;
            const repo = document.getElementById('githubRepo').value;
            
            if (!token) {
                showAlert('settingsAlert', '‚ùå Please enter a GitHub token', 'error');
                return;
            }
            
            localStorage.setItem('githubToken', token);
            localStorage.setItem('githubUsername', username);
            localStorage.setItem('githubRepo', repo);
            
            showAlert('settingsAlert', '‚úÖ Settings saved successfully!', 'success');
            checkSetup();
        }
        
        function clearSettings() {
            if (confirm('Clear all settings?')) {
                localStorage.removeItem('githubToken');
                localStorage.removeItem('githubUsername');
                localStorage.removeItem('githubRepo');
                document.getElementById('githubToken').value = '';
                showAlert('settingsAlert', 'üóëÔ∏è Settings cleared', 'info');
                checkSetup();
            }
        }
        
        // Load settings on page load
        const savedToken = localStorage.getItem('githubToken');
        const savedUsername = localStorage.getItem('githubUsername');
        const savedRepo = localStorage.getItem('githubRepo');
        
        if (savedToken) document.getElementById('githubToken').value = savedToken;
        if (savedUsername) document.getElementById('githubUsername').value = savedUsername;
        if (savedRepo) document.getElementById('githubRepo').value = savedRepo;
        
        checkSetup();
    </script>
</body>
</html>
